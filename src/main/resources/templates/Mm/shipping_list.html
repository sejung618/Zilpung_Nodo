<html layout:decorate="~{/layout}">
<div layout:fragment="content">
	<div class="d-sm-flex align-items-center justify-content-between mb-4">
		<h1 class="h3 mb-0 text-gray-800">출고현황</h1>
	</div>


	<div class="d-flex justify-content-between">
		<div class="btn-group" style="justify-content: start;">
			<button class="btn btn-success" type="button" id="state" value="all">전체</button>
			<button class="btn btn-success" type="button" id="state" value="nsp">미출고</button>
			<button class="btn btn-success" type="button" id="state" value="sp">출고</button>
		</div>

		<div class="form-inline" style="justify-content:end;">
			<div class="input-group">
				<input type="text" id="search_kw" class="form-control bg-light border-primary small" th:value="${kw}">
				<div class="input-group-append">
					<button class="btn btn-primary" type="button" id="btn_search">
						<i class="fas fa-search fa-sm" aria-hidden="true"></i>
					</button>
				</div>
			</div>
		</div>
	</div>



	<table class="table table-bordered table-hover-td">
		<thead class="table-primary">
			<tr class="text-center">
				<th>번호</th>
				<th>출고일자-No.</th>
				<th>거래처명</th>
				<th>품목명</th>
				<th>납기일자</th>
				<th>출고수량</th>
				<th>진행상태</th>
			</tr>
		</thead>
		<tbody>
			<tr class="text-center" th:each="shipping, loop : ${paging}">
				<td th:text="${paging.getTotalElements - (paging.number * paging.size) - loop.index}"></td>
				<td>
					<a th:href="@{|/shipping/detail/${shipping.spid}|}" th:text="${shipping.spnum}"></a>
				</td>
				<td th:text="${shipping.account.AC_Company}"></td>
				<td th:text="${shipping.item.ItmName}"></td>
				<td th:text="${shipping.spdt}"></td>
				<td th:text="${shipping.spcamount}"></td>
				<td th:text="${shipping.spstate}"></td>
			</tr>
		</tbody>
	</table>
	<!-- 페이징처리 시작 -->
	<div th:if="${!paging.isEmpty()}">
		<ul class="pagination justify-content-center">
			<li class="page-item" th:classappend="${!paging.hasPrevious} ? 'disabled'">
				<a class="page-link" href="javascript:void(0)" th:data-page="${paging.number-1}">
					<span>이전</span>
				</a>
			</li>
			<li th:each="page: ${#numbers.sequence(0, paging.totalPages-1)}"
				th:if="${page >= paging.number-5 and page <= paging.number+5}"
				th:classappend="${page == paging.number} ? 'active'" class="page-item">
				<a th:text="${page}" class="page-link" href="javascript:void(0)" th:data-page="${page}"></a>
			</li>
			<li class="page-item" th:classappend="${!paging.hasNext} ? 'disabled'">
				<a class="page-link" href="javascript:void(0)" th:data-page="${paging.number+1}">
					<span>다음</span>
				</a>
			</li>
		</ul>
	</div>
	<!-- 페이징처리 끝 -->
	<div class="col-6">
		<a th:href="@{/shipping/create}" class="btn btn-primary" style="left: 180%;"> 신규</a>
	</div>
	<form th:action="@{/shipping/list}" method="get" id="searchForm">
		<input type="hidden" id="kw" name="kw" th:value="${kw}">
		<input type="hidden" id="page" name="page" th:value="${paging.number}">
	</form>


	<script layout:fragment="script" type='text/javascript'>
		const page_elements = document.getElementsByClassName("page-link");
		Array.from(page_elements).forEach(function (element) {
			element.addEventListener('click', function () {
				document.getElementById('page').value = this.dataset.page;
				document.getElementById('searchForm').submit();
			});
		});
		const btn_search = document.getElementById("btn_search");
		btn_search.addEventListener('click', function () {
			document.getElementById('kw').value = document.getElementById('search_kw').value;
			document.getElementById('page').value = 0;  // 검색버튼을 클릭할 경우 0페이지부터 조회한다.
			document.getElementById('searchForm').submit();
		});
	</script>

</div>

</html>