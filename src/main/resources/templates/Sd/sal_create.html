<html layout:decorate="~{/layout}">
	<div layout:fragment="content" class="container my-3">
		<h1 class="my-3 border-bottom pb-2">판매 입력</h1>
		<form id="formA" th:action="@{/Sales/create}" th:object="${salesCreateForm}" method="post">
			<div class="alert alert-danger" role="alert" th:if="${#fields.hasAnyErrors()}">
				<div th:each="err : ${#fields.allErrors()}" th:text="${err}" />
			</div>
			
			<div class="mb-3">
				<label for="samethod">판매방법을 선택해주세요</label>
				<select name="samethod" id="samethod" class="form-control" style="width: 20%;">
					<option value="">-</option>
					<option value="예약">예약</option>
					<option value="온라인판매">온라인판매</option>
					<option value="오프라인판매">오프라인판매</option>
				</select>
			</div>
			
			<div id="reservationForm" style="display: none;">
				<!-- 예약 전용 폼 시작 -->
				<div>
					<label for="reservationDetails">예약물품정보</label>
					<select id="saitem" name="saitem" class="form-control" style="width: 40%;">
						<option value="">제품을 선택해주세요</option>
						<option th:each="reservation : ${ReserList}" th:value="${reservation.rvitem}" th:text="${reservation.rvitem}"
						 th:data-rv-price="${reservation.rvprice}"
						 th:data-rv-icode="${reservation.rvicode}" ></option>
					</select>
				</div>
				
				<div class="my-3">
					<label for="saicode">제품코드</label>
					<!--
					<input type="text" id="saicode" name="saicode" class="form-control saitem">
					-->
					<span id="saicode" class="form-control saicode" ><!-- 여기에 값이 표시됩니다 --></span>
				</div>
				
				<div class="my-3">
					<label for="saprice">제품가</label>
					<!--
					<input type="text" id="saprice" name="saprice" class="form-control saprice">
					-->
					<span id="saprice" class="form-control saprice"><!-- 여기에 값이 표시됩니다 --></span>
				</div>
				
				
				<!-- 예약 전용 폼 끝 -->
			</div>
			

			<script>
				$(document).ready(function(){
					$('#samethod').change(function() {
						var selectedValue = $(this).val(); // 선택한 값 가져오기
						var reservationForm = $('#reservationForm'); // 예약 전용 폼
				
						// 선택한 값이 '예약'일 때
						if (selectedValue === '예약') {
					
						// 예약 상세 정보 폼 보이기
						reservationForm.show();
					
						// 예약 항목 중복 제거 후 첫 번째 항목 선택
						var uniqueItems = {}; // 중복된 항목 제거를 위한 객체
						$('#saitem option').each(function() {
							uniqueItems[$(this).val()] = $(this).text();
						});
					
						$('#saitem').empty(); // 기존 옵션 제거
					
						$.each(uniqueItems, function(value, text) {
							$('#saitem').append($('<option>').text(text).attr('value', value));
						});
					
						// 첫 번째 예약 항목 선택
					
						var rvitem = $('#saitem').val();
	
						} else if (selectedValue === '오프라인판매') {
						// 선택한 값이 '예약'이 아닌 경우 예약 상세 정보 폼 숨기기
							reservationForm.hide();
						}
							});
							
							
							
						});
						
			</script>
			
			<script>
				$(document).ready(function(){
$('#saitem').change(function(){
    var selectedOption = $(this).find(':selected');
    var rvprice = selectedOption.attr("data-rv-price");
    var rvicode = selectedOption.attr("data-rv-icode");

    $('#saicode').text(rvicode);
    $('#saprice').text(rvprice);

    console.log(rvicode);
    console.log(rvprice);
});

});
				
			</script>
		</form>
	</div>
</html>